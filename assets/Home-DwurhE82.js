import{_ as g,o as n,c as V,w as o,a as e,V as i,b as _,d as y,e as t,f as b,g as c,h as w,u as C,i as m,j as v,F,r as R,k as f,l as k,m as x,n as E,p as T,q as B,s as N,t as $,v as U,x as I}from"./index-B4orVq1j.js";const q={name:"NavBar.vue"};function D(s,a,r,u,d,l){return n(),V(w,{class:"navbar align-center justify-space-between",color:"#1f4a61"},{default:o(()=>[e(c,{dense:""},{default:o(()=>[e(i,{cols:"2",class:"d-flex align-center"},{default:o(()=>[e(_,{class:"ml-4"},{default:o(()=>a[0]||(a[0]=[y("mdi-domain")])),_:1}),a[1]||(a[1]=t("h2",{class:"logo-enterprise ml-6"},"ECENG",-1)),a[2]||(a[2]=t("h2",{class:"logo-name"},"NEXUS",-1))]),_:1}),e(b)]),_:1})]),_:1})}const S=g(q,[["render",D],["__scopeId","data-v-3cfd1b42"]]),j={name:"TwoCardsExample",components:{NavBar:S},data:()=>({loading:!1,uploadedFile:null,selectedReportType:null,listReport:[{id:1,type:"Contas pagas por conta corrente"},{id:2,type:"Títulos por data"}]}),computed:{isFormValid(){return this.uploadedFile&&this.selectedReportType}},methods:{format(){this.uploadedFile="",this.selectedReportType=""},async formatAndDownloadReport(){console.log("Método chamado");const s=C();this.loading=!0;try{if(!this.isFormValid)throw new Error("Selecione um tipo de relatório e carregue um arquivo.");const a=new FormData;a.append("report",this.selectedReportType.type),a.append("myFile",this.uploadedFile),console.log(this.uploadedFile);const r=await fetch("http://localhost:3000/upload",{method:"POST",body:a});if(!r.ok)throw new Error(`Erro ao processar o relatório: ${r.status}`);const u=await r.blob(),d=window.URL.createObjectURL(u),l=document.createElement("a");l.href=d,l.download=`${this.uploadedFile.name}_formatado.xlsx`,document.body.appendChild(l),l.click(),document.body.removeChild(l),window.URL.revokeObjectURL(d),s.success("Relatório formatado com sucesso!")}catch(a){console.error(a.message),s.error(`Erro: ${a.message}`)}finally{this.loading=!1,this.format()}}}},A={class:"container"},L={key:0};function O(s,a,r,u,d,l){const h=R("NavBar");return n(),m(F,null,[e(h),e(v,null,{default:o(()=>[t("div",A,[e(f,{class:"card-first",color:"#1C4053"},{default:o(()=>a[2]||(a[2]=[t("div",{class:"green-card-container"},[t("h3",{class:"welcome"},"BEM-VINDO"),t("div",{class:"logo-name-container"},[t("h3",{class:"logo-name"},"Nexus")])],-1),t("p",{class:"slogan"}," Carregue sua planilha e deixe que nosso sistema a formate automaticamente. Simplifique suas tarefas e economize tempo! ",-1)])),_:1}),e(f,{class:"card-second",color:"#ffffff"},{default:o(()=>[e(c,null,{default:o(()=>[e(i,{class:"text-center"},{default:o(()=>[e(k,{class:"logo-img",src:"./img/eceng.png"})]),_:1})]),_:1}),e(x,{class:"form-container"},{default:o(()=>[e(E,null,{default:o(()=>[e(c,{dense:""},{default:o(()=>[e(i,{dense:""},{default:o(()=>[e(T,{label:"Escolha o tipo de relatório",class:"input-field",items:s.listReport,"item-title":"type","item-value":"id",modelValue:s.selectedReportType,"onUpdate:modelValue":a[0]||(a[0]=p=>s.selectedReportType=p),"prepend-icon":"mdi-menu",dense:"",outlined:"","hide-details":""},null,8,["items","modelValue"])]),_:1})]),_:1}),e(c,{dense:""},{default:o(()=>[e(i,null,{default:o(()=>[e(B,{label:"Carregue seu arquivo",class:"input-field",accept:".xlsx, .xls",modelValue:s.uploadedFile,"onUpdate:modelValue":a[1]||(a[1]=p=>s.uploadedFile=p),dense:"",outlined:"","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(N,null,{default:o(()=>[e($,null,{default:o(()=>[e(U,{class:"btn-login",disabled:!l.isFormValid||s.loading,onClick:l.formatAndDownloadReport},{default:o(()=>[s.loading?(n(),V(I,{key:1,indeterminate:"",color:"secondary",size:"24",class:"ml-2"})):(n(),m("span",L,"Formatar"))]),_:1},8,["disabled","onClick"])]),_:1})]),_:1})]),_:1})]),_:1})])]),_:1})],64)}const z=g(j,[["render",O],["__scopeId","data-v-6c7338a8"]]);export{z as default};
